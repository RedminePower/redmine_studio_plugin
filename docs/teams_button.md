# Teams Button

ユーザー名の横に「Teams」ボタンを追加し、ワンクリックでチャットを開始できる機能です。

## 概要

チケット画面に表示されるユーザー名（担当者、作成者、コメント投稿者など）の横に「Teams」ボタンを追加します。ボタンをクリックすると、Microsoft Teams のチャット画面が開き、チケット情報が自動入力された状態でメッセージを送信できます。

| 機能 | 説明 |
|------|------|
| Teams チャット起動 | ユーザーのメールアドレスを使用して Teams のチャット画面を開く |
| チケット情報の自動入力 | チケットのタイトル、URL、チケット番号がメッセージに自動入力される |

### ユースケース

- チケットの担当者に対して、チケットの内容について直接チャットで相談したい
- コメント投稿者に対して、追加の質問や確認をチャットで行いたい
- チケット情報を共有しながら、リアルタイムでコミュニケーションを取りたい

## 対応クライアント

| 要件 | 説明 |
|------|------|
| Office365 | Microsoft 365（旧 Office 365）のライセンスが必要 |
| DeepLink 対応 | Teams を起動するために DeepLink 機能を使用 |

動作確認済み環境：
- Windows 10
- Android

## 有効化

本機能はプロジェクトごとに有効・無効を切り替えられます。
以下の設定を行わないと「Teams」ボタンは表示されません。

1. プロジェクトの「設定」を開く
2. 「プロジェクト」タブ内の「モジュール」で「Teams button」にチェックを入れて保存

## 動作仕様

### 自動入力されるメッセージ内容

Teams チャットを開くと、以下の内容が自動入力されます：

| 項目 | 内容 |
|------|------|
| 1行目 | チケットのタイトル |
| 2行目 | チケットの URL |
| 3行目 | チケット参照（`refs #チケット番号`） |

### エラー時の動作

以下の場合はアラートダイアログでエラーメッセージを表示します：

- ユーザーのメールアドレスが取得できない場合
